{% extends 'base_dashboard.html' %}
{% block content %}

<br> <br>

<form class="form-inline my-2 my-lg-0" method="post">
  {% csrf_token %} 
  <div style="padding: 20px;">
  <input class="form-control mr-sm-2" type="search" placeholder="Search by Name" name="a_name" aria-label="Search">
  <input class="form-control mr-sm-2" type="search" placeholder="Search by Email" name="a_email" aria-label="Search">
  <button class="btn btn-outline-success my-2 my-sm-0" type="submit"> <i class="fa fa-search" aria-hidden="true"></i> Search</button>
  </div>
</form> <br> <br>  

<div class="shadow-lg p-3 mb-5 rounded" style="border-radius: 15px; background-color: rgba(255,255,255,0.13); text-align: center;"><h2>Employee Management</h2></div>
<br>




<div class="container">
  {% for msg in messages %}
          <div class="alert alert-warning alert-dismissible fade show" role="alert" style="background-color: rgb(187, 240, 187);">
               {{msg}}
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>                
  {% endfor %}
</div> 



  <div style="padding: 3px;">
  <div class="table-responsive">
  <table class="table" id="myTable" border="">
    <thead>
      <tr style="background-color: black; color: white;">
        <th scope="col">Name</th>
        <th scope="col">Email</th>
        <th scope="col">Employee ID</th>
        <th scope="col">Department</th>
        <th scope="col">Delete Record</th>
      </tr>
    </thead>
    <tbody>
        {% for i in data %}
      <tr style="background-color: #ededfc;">       
        <td>{{ i.full_name|title }}</td>
        <td>{{i.email_address}}</td>
        <td>{{i.emp_id}}</td>
        <td>{{i.department}}</td>

 
        <td>
          <form action="{% url 'DeleteEmp' %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="DeleteBtn" value="{{i.emp_id}}">
            <button type="submit" class="delete-button btn btn-outline-danger"><i class="fa fa-trash" aria-hidden="true"></i> Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
  </div>




  <script>
    document.querySelectorAll('.delete-button').forEach(button => {
      button.addEventListener('click', function (event) {
        event.preventDefault();
        if (confirm('Are you sure you want to delete this record?')) {
          event.target.closest('form').submit();
        }
      });
    });
  </script> 




  <br> <br>

<!-- Start CDN for Pagingnation and static search boxes  -->
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>

<script>
  $(document).ready(function () {
    $('#myTable').DataTable();
  });
</script>
<!-- End CDN for Pagingnation and static search boxes -->
  {% endblock %}


  